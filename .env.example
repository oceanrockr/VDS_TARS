# T.A.R.S. Environment Configuration
# Copy this file to .env and configure with your settings
# Version: v0.1.0-alpha

# ==============================================================================
# INFRASTRUCTURE SETTINGS
# ==============================================================================

# Host Configuration
HOST_IP=192.168.0.11
NAS_IP=192.168.0.10
LOCAL_DOMAIN=llm.local
NAS_DOMAIN=nas.local

# Network Ports
BACKEND_PORT=8000
OLLAMA_PORT=11434
CHROMADB_PORT=8001
UI_PORT=3000

# ==============================================================================
# BACKEND SERVICE
# ==============================================================================

# FastAPI Configuration
FASTAPI_ENV=development
FASTAPI_DEBUG=true
FASTAPI_RELOAD=true
API_V1_PREFIX=/api/v1
CORS_ORIGINS=http://localhost:3000,http://llm.local:3000

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json

# ==============================================================================
# OLLAMA LLM SERVICE
# ==============================================================================

# Ollama Configuration
OLLAMA_HOST=http://ollama:11434
OLLAMA_MODEL=mistral:7b-instruct
OLLAMA_GPU_LAYERS=-1
OLLAMA_NUM_THREAD=8
OLLAMA_CONTEXT_LENGTH=8192

# Model Parameters
MODEL_TEMPERATURE=0.7
MODEL_TOP_P=0.9
MODEL_TOP_K=40
MODEL_MAX_TOKENS=2048

# ==============================================================================
# CHROMADB VECTOR DATABASE
# ==============================================================================

# ChromaDB Configuration
CHROMA_HOST=http://chromadb:8001
CHROMA_PERSIST_DIRECTORY=/data/chroma
CHROMA_COLLECTION_NAME=tars_documents

# Embedding Model
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_DIMENSION=384
CHUNK_SIZE=512
CHUNK_OVERLAP=50

# ==============================================================================
# NAS AND STORAGE
# ==============================================================================

# NAS Mount Configuration
NAS_PROTOCOL=nfs
NAS_SHARE_PATH=/volume1/LLM_docs
NAS_MOUNT_POINT=/mnt/nas
NAS_USERNAME=tars_service
NAS_PASSWORD=

# Document Indexing
WATCH_DIRECTORIES=/mnt/nas/LLM_docs
SUPPORTED_EXTENSIONS=.pdf,.docx,.txt,.md,.csv
MAX_FILE_SIZE_MB=100
INDEXING_BATCH_SIZE=100

# ==============================================================================
# AUTHENTICATION & SECURITY
# ==============================================================================

# JWT Configuration
JWT_SECRET_KEY=your-secret-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=7

# Security
HTTPS_ENABLED=false
TLS_CERT_PATH=/etc/ssl/certs/tars.crt
TLS_KEY_PATH=/etc/ssl/private/tars.key
RATE_LIMIT_PER_MINUTE=60

# ==============================================================================
# WEBSOCKET CONFIGURATION
# ==============================================================================

# WebSocket Settings
WS_HEARTBEAT_INTERVAL=30
WS_MAX_CONNECTIONS=10
WS_MESSAGE_QUEUE_SIZE=100
WS_TIMEOUT_SECONDS=300

# ==============================================================================
# RAG CONFIGURATION (Phase 3)
# ==============================================================================

# ChromaDB Settings
CHROMA_COLLECTION_NAME=tars_documents
CHROMA_CONVERSATION_COLLECTION=tars_conversations
CHROMA_DISTANCE_METRIC=cosine
CHROMA_MAX_BATCH_SIZE=100

# Embedding Settings
EMBED_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBED_DIMENSION=384
EMBED_BATCH_SIZE=32
EMBED_DEVICE=cuda
EMBED_MAX_SEQ_LENGTH=256

# Document Processing
CHUNK_SIZE=512
CHUNK_OVERLAP=50
MAX_FILE_SIZE_MB=50
ALLOWED_EXTENSIONS=.pdf,.docx,.txt,.md,.csv
ENABLE_OCR=false

# Retrieval Settings
RAG_TOP_K=5
RAG_RELEVANCE_THRESHOLD=0.7
RAG_RERANK_ENABLED=true
RAG_INCLUDE_SOURCES=true
RAG_MAX_CONTEXT_TOKENS=2048

# NAS Configuration (Phase 4)
NAS_MOUNT_POINT=/mnt/nas/LLM_docs
NAS_WATCH_ENABLED=false
NAS_SCAN_INTERVAL=3600

# ==============================================================================
# PHASE 5: ADVANCED RAG CONFIGURATION
# ==============================================================================

# Semantic Chunking
USE_SEMANTIC_CHUNKING=true
SEMANTIC_CHUNK_MIN=400
SEMANTIC_CHUNK_MAX=800

# Advanced Reranking
USE_ADVANCED_RERANKING=true
RERANK_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2
RERANK_TOP_K=10
RERANK_WEIGHT=0.35

# Hybrid Search (BM25 + Vector)
USE_HYBRID_SEARCH=true
HYBRID_ALPHA=0.3

# Query Expansion (disabled by default - adds latency)
USE_QUERY_EXPANSION=false
QUERY_EXPANSION_ENABLED=false
QUERY_EXPANSION_MAX=3

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_LOG_PATH=./logs/analytics.log

# ==============================================================================
# MONITORING & OBSERVABILITY
# ==============================================================================

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Checks
HEALTH_CHECK_INTERVAL=30
READINESS_CHECK_TIMEOUT=5

# ==============================================================================
# PHASE 7 PART 2: OBSERVABILITY STACK
# ==============================================================================

# Observability Features
OBSERVABILITY_ENABLED=true
LOKI_ENABLED=true
JAEGER_ENABLED=true
KUBECOST_ENABLED=true

# Prometheus Alerting
PROM_ALERT_ERROR_THRESHOLD=0.005
PROM_ALERT_LATENCY_THRESHOLD_MS=250
PROM_ALERT_POD_RESTART_THRESHOLD=3

# Grafana
GRAFANA_ENABLED=true
GRAFANA_ADMIN_PASSWORD=changeme
GRAFANA_PORT=3000

# Loki (Log Aggregation)
LOKI_HOST=http://loki:3100
LOKI_RETENTION_DAYS=30

# Jaeger (Distributed Tracing)
JAEGER_ENABLED=true
JAEGER_AGENT_HOST=jaeger-agent
JAEGER_AGENT_PORT=6831
JAEGER_COLLECTOR_ENDPOINT=http://jaeger-collector:14268/api/traces
JAEGER_SAMPLING_RATE=1.0

# OpenTelemetry
OTEL_ENABLED=true
OTEL_SERVICE_NAME=tars-backend
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=1.0

# ==============================================================================
# MULTI-REGION DEPLOYMENT
# ==============================================================================

# Geographic Distribution
GEO_DNS_ENABLED=false
REGION_PRIMARY=us-east
REGION_SECONDARY=us-west

# Regional Configuration
AWS_REGION=us-east-1
REGION_NAME=us-east
IS_PRIMARY_REGION=true

# Database Replication
DATABASE_REPLICATION_ENABLED=false
DATABASE_PRIMARY_HOST=postgres-primary
DATABASE_REPLICA_HOST=postgres-replica
DATABASE_READONLY=false

# Redis Cluster
REDIS_CLUSTER_ENABLED=false
REDIS_CLUSTER_NODES=redis-cluster-0:6379,redis-cluster-1:6379,redis-cluster-2:6379
REDIS_CLUSTER_PASSWORD=

# Cross-Region Sync
CROSS_REGION_SYNC_ENABLED=false
CROSS_REGION_SYNC_INTERVAL=300

# ==============================================================================
# COST OPTIMIZATION
# ==============================================================================

# Kubecost
KUBECOST_ENABLED=false
KUBECOST_ENDPOINT=http://kubecost-cost-analyzer:9090
KUBECOST_DAILY_BUDGET=50
KUBECOST_MONTHLY_BUDGET=1000

# Vertical Pod Autoscaler
VPA_ENABLED=false
VPA_UPDATE_MODE=Auto

# Cluster Autoscaler
CLUSTER_AUTOSCALER_ENABLED=false
CLUSTER_MIN_NODES=3
CLUSTER_MAX_NODES=20

# Resource Retention
METRICS_RETENTION_DAYS=14
LOGS_RETENTION_DAYS=30
TRACES_RETENTION_DAYS=7

# ==============================================================================
# DEVELOPMENT & DEBUGGING
# ==============================================================================

# Debug Settings
DEBUG_MODE=false
VERBOSE_LOGGING=false
PROFILE_REQUESTS=false

# Testing
TEST_MODE=false
MOCK_OLLAMA=false
MOCK_CHROMADB=false

# ==============================================================================
# BACKUP & RECOVERY
# ==============================================================================

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 */6 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_DESTINATION=/mnt/nas/backups/tars

# ==============================================================================
# PHASE 9: FEDERATION & GOVERNANCE
# ==============================================================================

# Federation Configuration
FEDERATION_ENABLED=true
FEDERATION_HUB_URL=http://federation-hub:8080
FEDERATION_GRPC_URL=grpcs://federation-hub:50051
NODE_ID=node-001
CLUSTER_NAME=tars-cluster
REGION=us-east-1
NODE_CAPABILITIES=compute,inference,anomaly_detection

# Heartbeat Settings
FEDERATION_HEARTBEAT_INTERVAL=10
NODE_HEARTBEAT_TIMEOUT=30

# Consensus Configuration
CONSENSUS_ALGORITHM=raft
VOTE_TIMEOUT_SECONDS=300

# Storage Backend (postgres or etcd)
FEDERATION_STORAGE_BACKEND=postgres
POSTGRES_URL=postgresql://tars:tars@postgres:5432/federation
ETCD_ENDPOINTS=http://etcd:2379

# Governance & Policy Engine
GOVERNANCE_ENABLED=true
OPA_URL=http://opa:8181
POLICY_DIR=/app/policies

# Policy Evaluation
POLICY_AUDIT_ENABLED=true
ETHICAL_POLICIES_ENABLED=true

# ML Model Federation
MLSYNC_ENABLED=true
MLSYNC_AGGREGATION_METHOD=fedavg
MLSYNC_MIN_NODES=2
MODEL_STORAGE_DIR=/app/models

# TLS/mTLS for Federation
FEDERATION_TLS_ENABLED=true
FEDERATION_MTLS_ENABLED=true
FEDERATION_TLS_CERT_PATH=/certs/tls.crt
FEDERATION_TLS_KEY_PATH=/certs/tls.key
FEDERATION_TLS_CA_PATH=/certs/ca.crt

# Gossip Protocol
GOSSIP_INTERVAL=10
GOSSIP_FANOUT=3

# ==============================================================================
# PHASE 10: COGNITIVE FEDERATION & ADAPTIVE POLICY LEARNING
# ==============================================================================

# Cognitive Analytics Core
COGNITION_ENABLED=true
INSIGHT_ENGINE_URL=http://cognition-insight-engine:8090
INSIGHT_REFRESH_INTERVAL=60
ANALYSIS_WINDOW_MINUTES=60

# Policy Adaptation Thresholds
HIGH_VIOLATION_RATE_THRESHOLD=0.3
LOW_VIOLATION_RATE_THRESHOLD=0.05
HIGH_CONSENSUS_LATENCY_THRESHOLD=400.0
ETHICAL_FAIRNESS_THRESHOLD=0.75

# Sample Size Requirements
MIN_SAMPLE_SIZE_POLICY=50
MIN_SAMPLE_SIZE_ETHICAL=30
MIN_SAMPLE_SIZE_CONSENSUS=20

# Adaptive Policy Learner
ADAPTIVE_POLICY_LEARNING=true
POLICY_LEARNER_URL=http://policy-learner:8091
MIN_CONFIDENCE_THRESHOLD=0.8
ADAPTATION_APPROVAL_THRESHOLD=0.8
DRY_RUN_ENABLED=true
POLL_INTERVAL=60

# Meta-Consensus Optimizer
META_CONSENSUS_OPTIMIZER=true
META_OPTIMIZER_URL=http://meta-consensus-optimizer:8092
LATENCY_TARGET_MS=300.0
SUCCESS_RATE_TARGET=0.97
RL_LEARNING_RATE=0.1
RL_DISCOUNT_FACTOR=0.95
RL_EXPLORATION_RATE=0.2

# Federated Ethical Learning
ETHICAL_TRAINER_ENABLED=true
ETHICAL_TRAINER_URL=http://ethical-trainer:8093
FAIRNESS_MODEL_PATH=/app/fairness_model.pkl
ETHICAL_TRAINING_LOOKBACK_DAYS=30

# ==============================================================================
# PHASE 11: ADVANCED COGNITIVE ORCHESTRATION
# ==============================================================================

# Multi-Agent Reinforcement Learning
MARL_ENABLED=true
ORCHESTRATION_AGENT_URL=http://orchestration-agent:8094
ORCHESTRATION_PORT=8094
ORCHESTRATION_ENABLED=true

# DQN Agent Configuration (Phase 11.1)
DQN_LEARNING_RATE=0.001
DQN_GAMMA=0.95
DQN_EPSILON_START=1.0
DQN_EPSILON_END=0.01
DQN_EPSILON_DECAY=0.995
DQN_BATCH_SIZE=64
DQN_BUFFER_SIZE=10000
DQN_TARGET_UPDATE_FREQ=10
DQN_TAU=0.005
DQN_USE_DUELING=false
DQN_USE_PRIORITIZED_REPLAY=true

# Reward Aggregation Weights
REWARD_W_POLICY=0.30
REWARD_W_CONSENSUS=0.25
REWARD_W_ETHICAL=0.25
REWARD_W_RESOURCE=0.20
CONFLICT_PENALTY_BASE=0.1
COOPERATION_BONUS=1.2

# Nash Equilibrium Solver
NASH_METHOD=iterative_br
NASH_MAX_ITER=1000
NASH_TOLERANCE=1e-6
PARETO_EPSILON=1e-6

# A2C Agent Configuration (Phase 11.2 - Consensus Agent)
A2C_LEARNING_RATE=0.0007
A2C_GAMMA=0.99
A2C_GAE_LAMBDA=0.95
A2C_VALUE_LOSS_COEF=0.5
A2C_ENTROPY_COEF=0.01
A2C_MAX_GRAD_NORM=0.5

# PPO Agent Configuration (Phase 11.2 - Ethical Agent)
PPO_LEARNING_RATE=0.0003
PPO_GAMMA=0.99
PPO_GAE_LAMBDA=0.95
PPO_CLIP_EPSILON=0.2
PPO_VALUE_LOSS_COEF=0.5
PPO_ENTROPY_COEF=0.01
PPO_MAX_GRAD_NORM=0.5
PPO_N_EPOCHS=10
PPO_BATCH_SIZE=64
PPO_TARGET_KL=0.015
PPO_CLIP_VALUE_LOSS=false

# DDPG Agent Configuration (Phase 11.2 - Resource Agent)
DDPG_ACTOR_LR=0.0001
DDPG_CRITIC_LR=0.001
DDPG_GAMMA=0.99
DDPG_TAU=0.005
DDPG_BUFFER_SIZE=100000
DDPG_BATCH_SIZE=64
DDPG_NOISE_TYPE=ou
DDPG_NOISE_SIGMA=0.2

# Causal Inference Engine (Phase 11.1)
CAUSAL_INFERENCE_ENABLED=true
CAUSAL_ENGINE_ENABLED=true
CAUSAL_INFERENCE_URL=http://causal-inference:8095
CAUSAL_PORT=8095
CAUSAL_DISCOVERY_ALGORITHM=pc
CAUSAL_SIGNIFICANCE_ALPHA=0.05
CAUSAL_TEST_METHOD=pearson
CAUSAL_MAX_COND_VARS=3
CAUSAL_LOOKBACK_DAYS=30

# Intervention Estimation
INTERVENTION_METHOD=backdoor
CAUSAL_CONFIDENCE_THRESHOLD=0.7
ENABLE_COUNTERFACTUAL_SIMULATION=true

# Federated Meta-Learning
META_LEARNING_ENABLED=true
META_LEARNING_URL=http://meta-learning-coordinator:8096
FEDAVG_ROUNDS=10
MIN_CLUSTERS_FOR_FEDERATION=2
DIFFERENTIAL_PRIVACY_ENABLED=false
DP_NOISE_MULTIPLIER=1.1
DP_MAX_GRAD_NORM=1.0

# Transfer Learning
ENABLE_TRANSFER_LEARNING=true
COLD_START_MIN_SAMPLES=10
FINE_TUNING_LEARNING_RATE=0.001

# AutoML Pipeline (Phase 11.3)
AUTOML_ENABLED=true
AUTOML_URL=http://automl-optimizer:8097
AUTOML_PORT=8097

# Hyperparameter Optimization
OPTUNA_N_TRIALS=100
OPTUNA_TIMEOUT_SECONDS=600
OPTUNA_ALGORITHM=tpe
OPTUNA_SAMPLER=tpe
OPTUNA_PRUNER=median
OPTUNA_STORAGE=

# Feature Engineering
FEATURETOOLS_DEPTH=2
FEATURETOOLS_MAX_FEATURES=100
ENABLE_AUTOMATED_FEATURES=true

# Model Registry (MLflow)
MLFLOW_TRACKING_URI=/mnt/data/mlflow
MLFLOW_EXPERIMENT_NAME=tars_automl
MODEL_VERSIONING_ENABLED=true
MODEL_REGISTRY_BACKEND=mlflow

# Neural Architecture Search
ENABLE_NAS=false
NAS_SEARCH_SPACE=default
NAS_BUDGET_STEPS=100000

# Cognitive Orchestration Dashboard (Phase 11.3)
DASHBOARD_ENABLED=true
DASHBOARD_PORT=3000
DASHBOARD_API_PORT=3001
DASHBOARD_REFRESH_INTERVAL=5
ORCHESTRATION_SERVICE_URL=http://orchestration-agent:8094
AUTOML_SERVICE_URL=http://automl-optimizer:8097

# Dashboard Backend Storage (Phase 11.4)
USE_REDIS=true
REDIS_URL=redis://localhost:6379
REDIS_MAX_HISTORY_LENGTH=1000
REDIS_TTL_SECONDS=86400

# Hyperparameter Sync Service (Phase 11.4)
HYPERPARAM_SYNC_ENABLED=true
HYPERPARAM_SYNC_PORT=8098
APPROVAL_MODE=manual
AUTONOMOUS_THRESHOLD=0.03
VALIDATION_STRICTNESS=medium

# AutoML Real Training (Phase 11.4)
USE_REAL_TRAINING=true
USE_QUICK_MODE=false
REAL_TRAINING_EPISODES=50
REAL_EVAL_EPISODES=10
QUICK_MODE_TRAIN_EPISODES=10
QUICK_MODE_EVAL_EPISODES=5

# ==============================================================================
# ADVANCED SETTINGS
# ==============================================================================

# Performance Tuning
MAX_CONCURRENT_REQUESTS=10
REQUEST_TIMEOUT_SECONDS=120
DB_POOL_SIZE=10
CACHE_TTL_SECONDS=3600

# Docker Configuration
COMPOSE_PROJECT_NAME=tars
DOCKER_BUILDKIT=1
